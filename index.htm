<!DOCTYPE html>
<head>
<title>iBeacon Battery Monitor System</title>
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">   
<META HTTP-EQUIV="Cache-Control" CONTENT="no-cache"> 
<META HTTP-EQUIV="Expires" CONTENT="0"> 
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>
<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
<script language="javascript" type="text/javascript" src="js/jquery.js" ></script>
<script language="javascript" type="text/javascript" src="js/bootstrap.min.js"></script>
<link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
<link rel="icon" href="/favicon.ico">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<script language='javascript' type="text/javascript">
$(document).ready(function(){
	$("li").click(function(){
		$("li").removeClass("active");
		$(this).addClass("active");
	});

	getBeaconList();

});

var timer;
var uuid;
function getBeaconList(){
	if(timer) clearTimeout(timer);
	timer=setTimeout("getBeaconList()", 1000);
	$("#beacon_list_tmp").load("beacon_list", function(data){
		uuid=data.split(",")[0].split(":")[1];
		console.log("UUID: "+uuid);
		if($("#beacon_list").html()==""){
			$("#beacon_list").append("<div>"+uuid+"</div>");
		}else{
			var child = document.getElementById("beacon_list");
			var childnode=child.childNodes;
			var child_length=childnode.length;
			var exist=0;
			for(var i=0; i<child_length; i++){
				if(uuid == $(childnode[i]).html())
					exist=1;
			}
			if(exist==0)
				$("#beacon_list").append("<div>"+uuid+"</div>");
		}
console.log(data);
/*
		console.log(data.split(",")[0]);
		console.log(data.split(",")[1]);
		console.log(data.split(",")[2]);
		console.log(data.split(",")[3]);
		console.log(data.split(",")[4]);
*/
	});
}
</script>
</head>
<body>
<div style="height:1000px; width:100%">
<nav class="navbar navbar-inverse navbar-top">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar_list" aria-expended="false">
				<span class="glyphicon glyphicon-th-list" style="color:white"></span>
			</button>
			<a class="navbar-brand">iBeacon Battery Monitor System</a>
		</div>
		<div class="collapse navbar-collapse" id="navbar_list">
			<ul class="nav navbar-nav">
				<li class="active" style="cursor:pointer"><a>iBeacon List</a></li>
				<li class="" style="cursor:pointer"><a>Battery Status</a></li>
				<li id="cgi_test" class="" style="cursor:pointer"><a>....</a></li>
			</ul>
		</div>
	</div>
</nav>
<div id="beacon_list_tmp" style="display:none"></div>
<div id="beacon_list"></div>
</div>
</body>
</html>
